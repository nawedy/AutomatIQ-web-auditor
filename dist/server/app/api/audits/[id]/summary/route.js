(()=>{var e={};e.id=9701,e.ids=[9701],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5486:e=>{"use strict";e.exports=require("bcrypt")},7462:(e,t,r)=>{"use strict";r.d(t,{Gr:()=>n,zR:()=>a});var s=r(96330),i=r(88909);let a=globalThis.prisma??new s.PrismaClient({log:["error"],datasources:{db:{url:process.env.DATABASE_URL}}});async function n(e){try{await a.$executeRaw`SELECT set_config('app.current_user_id', ${e}, false)`}catch(e){throw console.error("Failed to set current user ID:",e),e}}process.env.DATABASE_URL&&new i.bC({connectionString:process.env.DATABASE_URL})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},13581:(e,t)=>{"use strict";t.A=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},16467:(e,t,r)=>{"use strict";r.d(t,{y:()=>i});var s=r(96330);function i(e){return{createUser:({id:t,...r})=>e.user.create(a(r)),getUser:t=>e.user.findUnique({where:{id:t}}),getUserByEmail:t=>e.user.findUnique({where:{email:t}}),async getUserByAccount(t){let r=await e.account.findUnique({where:{provider_providerAccountId:t},include:{user:!0}});return r?.user??null},updateUser:({id:t,...r})=>e.user.update({where:{id:t},...a(r)}),deleteUser:t=>e.user.delete({where:{id:t}}),linkAccount:t=>e.account.create({data:t}),unlinkAccount:t=>e.account.delete({where:{provider_providerAccountId:t}}),async getSessionAndUser(t){let r=await e.session.findUnique({where:{sessionToken:t},include:{user:!0}});if(!r)return null;let{user:s,...i}=r;return{user:s,session:i}},createSession:t=>e.session.create(a(t)),updateSession:t=>e.session.update({where:{sessionToken:t.sessionToken},...a(t)}),deleteSession:t=>e.session.delete({where:{sessionToken:t}}),async createVerificationToken(t){let r=await e.verificationToken.create(a(t));return"id"in r&&r.id&&delete r.id,r},async useVerificationToken(t){try{let r=await e.verificationToken.delete({where:{identifier_token:t}});return"id"in r&&r.id&&delete r.id,r}catch(e){if(e instanceof s.Prisma.PrismaClientKnownRequestError&&"P2025"===e.code)return null;throw e}},getAccount:async(t,r)=>e.account.findFirst({where:{providerAccountId:t,provider:r}}),createAuthenticator:async t=>e.authenticator.create(a(t)),getAuthenticator:async t=>e.authenticator.findUnique({where:{credentialID:t}}),listAuthenticatorsByUserId:async t=>e.authenticator.findMany({where:{userId:t}}),updateAuthenticatorCounter:async(t,r)=>e.authenticator.update({where:{credentialID:t},data:{counter:r}})}}function a(e){let t={};for(let r in e)void 0!==e[r]&&(t[r]=e[r]);return{data:t}}},19597:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>p,serverHooks:()=>h,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>d,POST:()=>l});var i=r(96559),a=r(48088),n=r(37719),u=r(32190),o=r(7462),c=r(43254);let d=(0,c.ru)(async(e,{params:t},r)=>{try{let{id:e}=t,s=await o.zR.audit.findFirst({where:{id:e,website:{userId:r.id}},include:{website:!0}});if(!s)return u.NextResponse.json({error:"Audit not found"},{status:404});let i=await o.zR.auditSummary.findUnique({where:{auditId:e}});if(!i)return u.NextResponse.json({error:"Summary not found"},{status:404});let a=await o.zR.auditCategoryScore.findMany({where:{auditSummaryId:i.id},include:{category:!0}}),n=await o.zR.auditResult.groupBy({by:["severity"],where:{auditId:e},_count:{id:!0}}),c=await o.zR.page.groupBy({by:["status"],where:{auditId:e},_count:{id:!0}});return u.NextResponse.json({audit:s,summary:{...i,categoryScores:a,issueCounts:n,pageCounts:c}})}catch(e){return console.error(`Error fetching summary for audit ${t.id}:`,e),u.NextResponse.json({error:"Failed to fetch audit summary"},{status:500})}}),l=(0,c.ru)(async(e,{params:t},r)=>{try{let{id:e}=t;if(!await o.zR.audit.findFirst({where:{id:e,website:{userId:r.id}}}))return u.NextResponse.json({error:"Audit not found"},{status:404});let s=await o.zR.auditResult.findMany({where:{auditId:e},include:{check:{include:{category:!0}}}}),i=await o.zR.page.findMany({where:{auditId:e}}),a=await o.zR.auditCategory.findMany(),n={};a.forEach(e=>{n[e.id]={categoryId:e.id,score:100,issueCount:0,passedCount:0,warningCount:0,errorCount:0}}),s.forEach(e=>{let t=e.check.categoryId;n[t]&&(n[t].issueCount++,"passed"===e.status?n[t].passedCount++:"warning"===e.status?(n[t].warningCount++,"high"===e.severity?n[t].score-=5:"medium"===e.severity?n[t].score-=3:n[t].score-=1):"error"===e.status&&(n[t].errorCount++,"high"===e.severity?n[t].score-=10:"medium"===e.severity?n[t].score-=7:n[t].score-=3),n[t].score=Math.max(0,n[t].score))});let c={seo:.25,performance:.25,accessibility:.2,security:.2,best_practices:.1},d=0,l=0;Object.entries(n).forEach(([e,t])=>{let r=a.find(t=>t.id===e);r&&c[r.slug]&&(d+=t.score*c[r.slug],l+=c[r.slug])}),d=l>0?Math.round(d/l):0;let p=await o.zR.auditSummary.upsert({where:{auditId:e},update:{overallScore:d,totalPages:i.length,totalIssues:s.filter(e=>"passed"!==e.status).length,highSeverityIssues:s.filter(e=>"high"===e.severity&&"passed"!==e.status).length,mediumSeverityIssues:s.filter(e=>"medium"===e.severity&&"passed"!==e.status).length,lowSeverityIssues:s.filter(e=>"low"===e.severity&&"passed"!==e.status).length,completedAt:new Date},create:{auditId:e,overallScore:d,totalPages:i.length,totalIssues:s.filter(e=>"passed"!==e.status).length,highSeverityIssues:s.filter(e=>"high"===e.severity&&"passed"!==e.status).length,mediumSeverityIssues:s.filter(e=>"medium"===e.severity&&"passed"!==e.status).length,lowSeverityIssues:s.filter(e=>"low"===e.severity&&"passed"!==e.status).length,completedAt:new Date}}),m=Object.values(n).map(e=>o.zR.auditCategoryScore.upsert({where:{auditSummaryId_categoryId:{auditSummaryId:p.id,categoryId:e.categoryId}},update:{score:e.score,issueCount:e.issueCount,passedCount:e.passedCount,warningCount:e.warningCount,errorCount:e.errorCount},create:{auditSummaryId:p.id,categoryId:e.categoryId,score:e.score,issueCount:e.issueCount,passedCount:e.passedCount,warningCount:e.warningCount,errorCount:e.errorCount}}));await Promise.all(m),await o.zR.audit.update({where:{id:e},data:{status:"completed",completedAt:new Date}});let y=await o.zR.auditSummary.findUnique({where:{auditId:e},include:{categoryScores:{include:{category:!0}}}});return u.NextResponse.json({summary:y})}catch(e){return console.error(`Error generating summary for audit ${t.id}:`,e),u.NextResponse.json({error:"Failed to generate audit summary"},{status:500})}}),p=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/audits/[id]/summary/route",pathname:"/api/audits/[id]/summary",filename:"route",bundlePath:"app/api/audits/[id]/summary/route"},resolvedPagePath:"/Users/drgn003/AutomatIQ/AI-website-auditor/app/api/audits/[id]/summary/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:y,serverHooks:h}=p;function g(){return(0,n.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:y})}},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},36344:(e,t)=>{"use strict";t.A=function(e){return{id:"google",name:"Google",type:"oauth",wellKnown:"https://accounts.google.com/.well-known/openid-configuration",authorization:{params:{scope:"openid email profile"}},idToken:!0,checks:["pkce","state"],profile:e=>({id:e.sub,name:e.name,email:e.email,image:e.picture}),style:{logo:"/google.svg",bg:"#fff",text:"#000"},options:e}}},43254:(e,t,r)=>{"use strict";r.d(t,{ru:()=>u});var s=r(7462),i=r(19854),a=r(86753),n=r(32190);function u(e){return async(t,r)=>{try{let u=await (0,i.getServerSession)(a.N);if(!u?.user?.email)return n.NextResponse.json({error:"Unauthorized"},{status:401});let o=await s.zR.user.findUnique({where:{email:u.user.email},select:{id:!0,email:!0}});if(!o)return n.NextResponse.json({error:"User not found"},{status:404});return await (0,s.Gr)(o.id),e(t,r,o)}catch(e){return console.error("Authentication error:",e),n.NextResponse.json({error:"Authentication failed"},{status:500})}}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65752:(e,t)=>{"use strict";t.A=function(e){return{id:"github",name:"GitHub",type:"oauth",authorization:{url:"https://github.com/login/oauth/authorize",params:{scope:"read:user user:email"}},token:"https://github.com/login/oauth/access_token",userinfo:{url:"https://api.github.com/user",async request({client:e,tokens:t}){let r=await e.userinfo(t.access_token);if(!r.email){let e=await fetch("https://api.github.com/user/emails",{headers:{Authorization:`token ${t.access_token}`}});if(e.ok){var s;let t=await e.json();r.email=(null!=(s=t.find(e=>e.primary))?s:t[0]).email}}return r}},profile(e){var t;return{id:e.id.toString(),name:null!=(t=e.name)?t:e.login,email:e.email,image:e.avatar_url}},style:{logo:"/github.svg",bg:"#24292f",text:"#fff"},options:e}}},74075:e=>{"use strict";e.exports=require("zlib")},76926:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return o}});let s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var s={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var u=a?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(s,n,u):s[n]=e[n]}return s.default=e,r&&r.set(e,s),s}(r(61120));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}let a={current:null},n="function"==typeof s.cache?s.cache:e=>e,u=console.warn;function o(e){return function(...t){u(e(...t))}}n(e=>{try{u(a.current)}finally{a.current=null}})},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},86753:(e,t,r)=>{"use strict";r.d(t,{N:()=>d});var s=r(16467),i=r(13581),a=r(36344),n=r(65752),u=r(96330),o=r(5486);r(19854);let c=new u.PrismaClient,d={adapter:(0,s.y)(c),session:{strategy:"jwt"},pages:{signIn:"/auth/login",signOut:"/auth/logout",error:"/auth/error"},providers:[(0,i.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await c.user.findUnique({where:{email:e.email}});return t&&t.password&&await (0,o.compare)(e.password,t.password)?{id:t.id,email:t.email,name:t.name,image:t.image}:null}}),(0,a.A)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||""}),(0,n.A)({clientId:process.env.GITHUB_CLIENT_ID||"",clientSecret:process.env.GITHUB_CLIENT_SECRET||""})],callbacks:{session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.name=t.name,e.user.email=t.email,e.user.image=t.picture),e),jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e)}}},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,580,9854,8909],()=>r(19597));module.exports=s})();