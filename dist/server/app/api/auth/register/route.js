(()=>{var e={};e.id=1612,e.ids=[1612],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41098:(e,r,s)=>{"use strict";s.d(r,{N:()=>a,u:()=>i});let t=[{id:"1",email:"admin@example.com",name:"Admin User",password_hash:"hashed_admin_password",role:"admin",subscription:"enterprise",created_at:new Date().toISOString()},{id:"2",email:"user@example.com",name:"Demo User",password_hash:"hashed_user_password",role:"user",subscription:"pro",created_at:new Date().toISOString()}],a={providers:[{id:"credentials",name:"Credentials",type:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},authorize:async e=>{if(!e?.email||!e?.password)return null;try{let r=await i.findByEmail(e.email);if(!r||!await i.comparePassword(e.password,r.password_hash))return null;return{id:r.id,email:r.email,name:r.name,role:r.role,subscription:r.subscription}}catch(e){return null}}}],session:{strategy:"jwt",maxAge:2592e3},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id,e.email=r.email,e.name=r.name,e.role=r.role,e.subscription=r.subscription),e),session:async({session:e,token:r})=>(r&&(e.user.id=r.id,e.user.email=r.email,e.user.name=r.name,e.user.role=r.role,e.user.subscription=r.subscription),e)},pages:{signIn:"/login",error:"/login"},secret:process.env.NEXTAUTH_SECRET||"your-fallback-secret-key-for-development"};class i{static async hashPassword(e){return`hashed_${e}`}static async comparePassword(e,r){return r===`hashed_${e}`}static generateToken(e){return btoa(JSON.stringify(e))}static verifyToken(e){try{return JSON.parse(atob(e))}catch{return null}}static async register(e,r,s){if(t.find(r=>r.email===e))throw Error("User already exists");let a={id:(t.length+1).toString(),email:e,name:s,password_hash:await this.hashPassword(r),role:"user",subscription:"free",created_at:new Date().toISOString()};t.push(a);let i=this.generateToken({userId:a.id,email:a.email,role:a.role});return{user:a,token:i}}static async login(e,r){let s=t.find(r=>r.email===e);if(!s||!await this.comparePassword(r,s.password_hash))throw Error("Invalid credentials");let a=this.generateToken({userId:s.id,email:s.email,role:s.role});return{user:s,token:a}}static async getUserFromToken(e){let r=this.verifyToken(e);if(!r)throw Error("Invalid token");let s=t.find(e=>e.id===r.userId);if(!s)throw Error("User not found");return s}static async findByEmail(e){return t.find(r=>r.email===e)||null}static async findById(e){return t.find(r=>r.id===e)||null}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74799:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>h,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>p});var t={};s.r(t),s.d(t,{POST:()=>u});var a=s(96559),i=s(48088),n=s(37719),o=s(32190),l=s(41098);async function u(e){try{let{email:r,password:s,name:t}=await e.json();if(!r||!s||!t)return o.NextResponse.json({error:"Missing required fields"},{status:400});if(s.length<6)return o.NextResponse.json({error:"Password must be at least 6 characters"},{status:400});let{user:a,token:i}=await l.u.register(r,s,t),n=o.NextResponse.json({user:{id:a.id,email:a.email,name:a.name,role:a.role,subscription:a.subscription},token:i});return n.cookies.set("auth_token",i,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),n}catch(e){return console.error("Registration error:",e),o.NextResponse.json({error:e instanceof Error?e.message:"Registration failed"},{status:400})}}let d=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/drgn003/AutomatIQ/AI-website-auditor/app/api/auth/register/route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:c,workUnitAsyncStorage:p,serverHooks:m}=d;function h(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:p})}},78335:()=>{},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4243,580],()=>s(74799));module.exports=t})();