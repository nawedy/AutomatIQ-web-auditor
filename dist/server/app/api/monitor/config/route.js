"use strict";(()=>{var e={};e.id=5885,e.ids=[5885],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5486:e=>{e.exports=require("bcrypt")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{e.exports=require("querystring")},12412:e=>{e.exports=require("assert")},21820:e=>{e.exports=require("os")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32325:e=>{e.exports=require("jsdom")},33873:e=>{e.exports=require("path")},34631:e=>{e.exports=require("tls")},37366:e=>{e.exports=require("dns")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{e.exports=require("zlib")},77598:e=>{e.exports=require("node:crypto")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},79646:e=>{e.exports=require("child_process")},81630:e=>{e.exports=require("http")},91645:e=>{e.exports=require("net")},94735:e=>{e.exports=require("events")},95105:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>j,routeModule:()=>h,serverHooks:()=>R,workAsyncStorage:()=>b,workUnitAsyncStorage:()=>y});var o={};t.r(o),t.d(o,{DELETE:()=>q,GET:()=>m,POST:()=>w});var s=t(96559),i=t(48088),n=t(37719),a=t(32190),u=t(43254),p=t(72820),c=t(96330),d=t(51672),l=t(68803),g=t(49481);let x=new c.PrismaClient,f=new d.GL(x),m=(0,p.Y)((0,u.ru)(async(e,r,t)=>{try{let{searchParams:r}=new URL(e.url),o=r.get("websiteId");if(!o)return a.NextResponse.json({error:"Website ID is required"},{status:400});if(!await x.website.findFirst({where:{id:o,OR:[{userId:t.id},{user:{role:"ADMIN"}}]}}))return a.NextResponse.json({error:"Website not found or you do not have permission to access it"},{status:404});try{let e=await f.getMonitoringConfig(o);if(!e)return a.NextResponse.json({websiteId:o,enabled:!1,frequency:"WEEKLY",alertThreshold:10,metrics:["overallScore","seoScore","performanceScore"],emailNotifications:!0,slackWebhook:null});return a.NextResponse.json(e)}catch(e){return console.error("Error fetching monitoring config:",e),a.NextResponse.json({error:`Failed to fetch monitoring configuration: ${e.message}`},{status:500})}}catch(e){return console.error("Error fetching monitoring config:",e),a.NextResponse.json({error:`Failed to fetch monitoring configuration: ${e.message}`},{status:500})}finally{await x.$disconnect()}}),{requestsPerWindow:20,window:"60 s"}),w=(0,p.Y)((0,u.ru)(async(e,r,t)=>{try{let r=await e.json(),{websiteId:o,enabled:s,frequency:i,alertThreshold:n,metrics:u,emailNotifications:p,slackWebhook:c}=(0,g.Zm)(r);if(!o)return a.NextResponse.json({error:"Website ID is required"},{status:400});if(!(0,l.aJ)(o))return a.NextResponse.json({error:"Invalid website ID format"},{status:400});let d=c?(0,g.Jf)(c):null;if(c&&!(0,l.r8)(d))return a.NextResponse.json({error:"Slack webhook URL must use HTTPS protocol"},{status:400});if(!await x.website.findFirst({where:{id:o,OR:[{userId:t.id},{user:{role:"ADMIN"}}]}}))return a.NextResponse.json({error:"Website not found or you do not have permission to access it"},{status:404});try{let e={enabled:!!s,frequency:String(i),alertThreshold:Number(n),metrics:Array.isArray(u)?u:[],emailNotifications:!!p,slackWebhook:d||void 0};await f.updateMonitoringConfig(o,e)}catch(e){return console.error("Error updating monitoring config:",e),a.NextResponse.json({error:`Failed to update monitoring configuration: ${e.message}`},{status:500})}return a.NextResponse.json({success:!0,message:"Monitoring configuration updated successfully"})}catch(e){return console.error("Error updating monitoring config:",e),a.NextResponse.json({error:`Failed to update monitoring configuration: ${e.message}`},{status:500})}finally{await x.$disconnect()}}),{requestsPerWindow:10,window:"60 s"}),q=(0,p.Y)((0,u.ru)(async(e,r,t)=>{try{let{searchParams:r}=new URL(e.url),o=r.get("websiteId");if(!o)return a.NextResponse.json({error:"Website ID is required"},{status:400});if(!await x.website.findFirst({where:{id:o,OR:[{userId:t.id},{user:{role:"ADMIN"}}]}}))return a.NextResponse.json({error:"Website not found or you do not have permission to access it"},{status:404});try{await f.updateMonitoringConfig(o,{enabled:!1})}catch(e){return console.error("Error disabling monitoring:",e),a.NextResponse.json({error:`Failed to disable monitoring: ${e.message}`},{status:500})}return a.NextResponse.json({success:!0,message:"Monitoring disabled successfully"})}catch(e){return console.error("Error disabling monitoring:",e),a.NextResponse.json({error:`Failed to disable monitoring: ${e.message}`},{status:500})}finally{await x.$disconnect()}}),{requestsPerWindow:10,window:"60 s"}),h=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/monitor/config/route",pathname:"/api/monitor/config",filename:"route",bundlePath:"app/api/monitor/config/route"},resolvedPagePath:"/Users/drgn003/AutomatIQ/AI-website-auditor/app/api/monitor/config/route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:b,workUnitAsyncStorage:y,serverHooks:R}=h;function j(){return(0,n.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:y})}},96330:e=>{e.exports=require("@prisma/client")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[4243,580,9854,8909,9526,1426,8420,5145,1320,2729,1672,4907],()=>t(95105));module.exports=o})();