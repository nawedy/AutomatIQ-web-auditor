(()=>{var e={};e.id=9454,e.ids=[9454],e.modules={278:(e,t,r)=>{"use strict";function i(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}r.d(t,{w:()=>i})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5486:e=>{"use strict";e.exports=require("bcrypt")},7462:(e,t,r)=>{"use strict";r.d(t,{Gr:()=>n,zR:()=>o});var i=r(96330),s=r(88909);let o=globalThis.prisma??new i.PrismaClient({log:["error"],datasources:{db:{url:process.env.DATABASE_URL}}});async function n(e){try{await o.$executeRaw`SELECT set_config('app.current_user_id', ${e}, false)`}catch(e){throw console.error("Failed to set current user ID:",e),e}}process.env.DATABASE_URL&&new s.bC({connectionString:process.env.DATABASE_URL})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10945:(e,t,r)=>{var i=r(94339);t.operation=function(e){return new i(t.timeouts(e),{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw Error("minTimeout is greater than maxTimeout");for(var i=[],s=0;s<t.retries;s++)i.push(this.createTimeout(s,t));return e&&e.forever&&!i.length&&i.push(this.createTimeout(s,t)),i.sort(function(e,t){return e-t}),i},t.createTimeout=function(e,t){var r=Math.round((t.randomize?Math.random()+1:1)*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return Math.min(r,t.maxTimeout)},t.wrap=function(e,r,i){if(r instanceof Array&&(i=r,r=null),!i)for(var s in i=[],e)"function"==typeof e[s]&&i.push(s);for(var o=0;o<i.length;o++){var n=i[o],a=e[n];e[n]=(function(i){var s=t.operation(r),o=Array.prototype.slice.call(arguments,1),n=o.pop();o.push(function(e){s.retry(e)||(e&&(arguments[0]=s.mainError()),n.apply(this,arguments))}),s.attempt(function(){i.apply(e,o)})}).bind(e,a),e[n].options=r}}},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},13581:(e,t)=>{"use strict";t.A=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},14133:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});var i=r(90672),s=r(278);function o(e,t){let r=(0,i.a)(e);if(isNaN(t))return(0,s.w)(e,NaN);if(!t)return r;let o=r.getDate(),n=(0,s.w)(e,r.getTime());return(n.setMonth(r.getMonth()+t+1,0),o>=n.getDate())?n:(r.setFullYear(n.getFullYear(),n.getMonth(),o),r)}},16467:(e,t,r)=>{"use strict";r.d(t,{y:()=>s});var i=r(96330);function s(e){return{createUser:({id:t,...r})=>e.user.create(o(r)),getUser:t=>e.user.findUnique({where:{id:t}}),getUserByEmail:t=>e.user.findUnique({where:{email:t}}),async getUserByAccount(t){let r=await e.account.findUnique({where:{provider_providerAccountId:t},include:{user:!0}});return r?.user??null},updateUser:({id:t,...r})=>e.user.update({where:{id:t},...o(r)}),deleteUser:t=>e.user.delete({where:{id:t}}),linkAccount:t=>e.account.create({data:t}),unlinkAccount:t=>e.account.delete({where:{provider_providerAccountId:t}}),async getSessionAndUser(t){let r=await e.session.findUnique({where:{sessionToken:t},include:{user:!0}});if(!r)return null;let{user:i,...s}=r;return{user:i,session:s}},createSession:t=>e.session.create(o(t)),updateSession:t=>e.session.update({where:{sessionToken:t.sessionToken},...o(t)}),deleteSession:t=>e.session.delete({where:{sessionToken:t}}),async createVerificationToken(t){let r=await e.verificationToken.create(o(t));return"id"in r&&r.id&&delete r.id,r},async useVerificationToken(t){try{let r=await e.verificationToken.delete({where:{identifier_token:t}});return"id"in r&&r.id&&delete r.id,r}catch(e){if(e instanceof i.Prisma.PrismaClientKnownRequestError&&"P2025"===e.code)return null;throw e}},getAccount:async(t,r)=>e.account.findFirst({where:{providerAccountId:t,provider:r}}),createAuthenticator:async t=>e.authenticator.create(o(t)),getAuthenticator:async t=>e.authenticator.findUnique({where:{credentialID:t}}),listAuthenticatorsByUserId:async t=>e.authenticator.findMany({where:{userId:t}}),updateAuthenticatorCounter:async(t,r)=>e.authenticator.update({where:{credentialID:t},data:{counter:r}})}}function o(e){let t={};for(let r in e)void 0!==e[r]&&(t[r]=e[r]);return{data:t}}},21820:e=>{"use strict";e.exports=require("os")},27650:(e,t,r)=>{"use strict";r.d(t,{e:()=>s});var i=r(59217);function s(e,t){return(0,i.f)(e,-t)}},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36344:(e,t)=>{"use strict";t.A=function(e){return{id:"google",name:"Google",type:"oauth",wellKnown:"https://accounts.google.com/.well-known/openid-configuration",authorization:{params:{scope:"openid email profile"}},idToken:!0,checks:["pkce","state"],profile:e=>({id:e.sub,name:e.name,email:e.email,image:e.picture}),style:{logo:"/google.svg",bg:"#fff",text:"#000"},options:e}}},37366:e=>{"use strict";e.exports=require("dns")},43254:(e,t,r)=>{"use strict";r.d(t,{ru:()=>a});var i=r(7462),s=r(19854),o=r(86753),n=r(32190);function a(e){return async(t,r)=>{try{let a=await (0,s.getServerSession)(o.N);if(!a?.user?.email)return n.NextResponse.json({error:"Unauthorized"},{status:401});let u=await i.zR.user.findUnique({where:{email:a.user.email},select:{id:!0,email:!0}});if(!u)return n.NextResponse.json({error:"User not found"},{status:404});return await (0,i.Gr)(u.id),e(t,r,u)}catch(e){return console.error("Authentication error:",e),n.NextResponse.json({error:"Authentication failed"},{status:500})}}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},52438:(e,t,r)=>{"use strict";let i=r(82971),s=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class o extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}let n=(e,t,r)=>{let i=r.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=i,e},a=e=>s.includes(e),u=(e,t)=>new Promise((r,s)=>{t={onFailedAttempt:()=>{},retries:10,...t};let u=i.operation(t);u.attempt(async i=>{try{r(await e(i))}catch(e){if(!(e instanceof Error))return void s(TypeError(`Non-error was thrown: "${e}". You should only throw errors.`));if(e instanceof o)u.stop(),s(e.originalError);else if(e instanceof TypeError&&!a(e.message))u.stop(),s(e);else{n(e,i,t);try{await t.onFailedAttempt(e)}catch(e){s(e);return}u.retry(e)||s(u.mainError())}}})});e.exports=u,e.exports.default=u,e.exports.AbortError=o},55465:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>T,routeModule:()=>g,serverHooks:()=>_,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>y});var i={};r.r(i),r.d(i,{GET:()=>h});var s=r(96559),o=r(48088),n=r(37719),a=r(32190),u=r(43254),c=r(72820),l=r(96330),p=r(27650),m=r(51672);let d=new l.PrismaClient,f=new m.GL(d),h=(0,c.Y)((0,u.ru)(async(e,t,r)=>{try{let{searchParams:t}=new URL(e.url),i=t.get("websiteId"),s=t.get("timeRange")||"30days",o=t.get("metrics")||"overallScore,seoScore,performanceScore,accessibilityScore";if(!i)return a.NextResponse.json({error:"Website ID is required"},{status:400});let n=await d.website.findFirst({where:{id:i,OR:[{userId:r.id},{user:{role:"ADMIN"}}]}});if(!n)return a.NextResponse.json({error:"Website not found or you do not have permission to access it"},{status:404});let u={};switch(s){case"7days":u={gte:(0,p.e)(new Date,7)};break;case"30days":u={gte:(0,p.e)(new Date,30)};break;case"90days":u={gte:(0,p.e)(new Date,90)};break;case"365days":u={gte:(0,p.e)(new Date,365)}}let c=o.split(","),l=await d.audit.findMany({where:{websiteId:i,status:"COMPLETED",...Object.keys(u).length>0?{completedAt:u}:{}},select:{id:!0,createdAt:!0,completedAt:!0,overallScore:c.includes("overallScore"),seoScore:c.includes("seoScore"),performanceScore:c.includes("performanceScore"),accessibilityScore:c.includes("accessibilityScore"),securityScore:c.includes("securityScore"),mobileScore:c.includes("mobileScore"),contentScore:c.includes("contentScore"),issueCount:!0},orderBy:{completedAt:"asc"}}),m=await f.getAlertsFromCacheOrDatabase(i,1,10,!1),h=Object.keys(u).length>0?m.filter(e=>{let t=new Date(e.createdAt),r=u.gte;return t>=r}):m,g={};if(l.length>=2){let e=l[0],t=l[l.length-1];g=c.reduce((r,i)=>{if(void 0!==e[i]&&void 0!==t[i]){let s=e[i],o=t[i]-s,n=s>0?Math.round(o/s*100):0;r[i]={diff:o,percentage:n,improved:o>0}}return r},{})}let w=await f.getMonitoringConfig(i);return a.NextResponse.json({websiteId:i,websiteName:n.name,websiteUrl:n.url,timeRange:s,auditHistory:l,alerts:h,trends:g,monitoringConfig:w||{enabled:!1,frequency:"WEEKLY",alertThreshold:10,metrics:["overallScore","seoScore","performanceScore"]}})}catch(e){return console.error("Error fetching monitoring data:",e),a.NextResponse.json({error:`Failed to fetch monitoring data: ${e.message}`},{status:500})}finally{await d.$disconnect()}}),{requestsPerWindow:20,window:"60 s",identifierFn:e=>{let t=new URL(e.url).searchParams.get("websiteId")||"unknown",r=e.headers.get("x-session-user"),i="anonymous";if(r)try{i=JSON.parse(r).id}catch(e){}let s=e.headers.get("x-forwarded-for"),o=s?s.split(",")[0].trim():"unknown";return`monitor_${t}_${i}_${o}`}}),g=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/monitor/continuous/route",pathname:"/api/monitor/continuous",filename:"route",bundlePath:"app/api/monitor/continuous/route"},resolvedPagePath:"/Users/drgn003/AutomatIQ/AI-website-auditor/app/api/monitor/continuous/route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:w,workUnitAsyncStorage:y,serverHooks:_}=g;function T(){return(0,n.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:y})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},59217:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});var i=r(90672),s=r(278);function o(e,t){let r=(0,i.a)(e);return isNaN(t)?(0,s.w)(e,NaN):(t&&r.setDate(r.getDate()+t),r)}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65752:(e,t)=>{"use strict";t.A=function(e){return{id:"github",name:"GitHub",type:"oauth",authorization:{url:"https://github.com/login/oauth/authorize",params:{scope:"read:user user:email"}},token:"https://github.com/login/oauth/access_token",userinfo:{url:"https://api.github.com/user",async request({client:e,tokens:t}){let r=await e.userinfo(t.access_token);if(!r.email){let e=await fetch("https://api.github.com/user/emails",{headers:{Authorization:`token ${t.access_token}`}});if(e.ok){var i;let t=await e.json();r.email=(null!=(i=t.find(e=>e.primary))?i:t[0]).email}}return r}},profile(e){var t;return{id:e.id.toString(),name:null!=(t=e.name)?t:e.login,email:e.email,image:e.avatar_url}},style:{logo:"/github.svg",bg:"#24292f",text:"#fff"},options:e}}},72820:(e,t,r)=>{"use strict";let i,s;r.d(t,{Y:()=>u});var o=r(32190),n=r(35943),a=r(5145);function u(e,t){return async function(r,...n){if(!i||!s)return console.warn("Rate limiting is not configured. Set UPSTASH_REDIS_REST_URL and UPSTASH_REDIS_REST_TOKEN env variables."),e(r,...n);let u=s;t?.requestsPerWindow&&t?.window&&(u=new a.Ratelimit({redis:i,limiter:a.Ratelimit.slidingWindow(t.requestsPerWindow,t.window),analytics:!0}));let c=t?.identifierFn?t.identifierFn(r):r.ip||"anonymous",{success:l,limit:p,reset:m,remaining:d}=await u.limit(c),f=new Headers({"X-RateLimit-Limit":p.toString(),"X-RateLimit-Remaining":d.toString(),"X-RateLimit-Reset":m.toString()});if(!l)return new o.NextResponse(JSON.stringify({error:"Too many requests",message:"Please try again later"}),{status:429,headers:f});let h=await e(r,...n);return Object.entries(f).forEach(([e,t])=>{h.headers.set(e,t)}),h}}process.env.UPSTASH_REDIS_REST_URL&&process.env.UPSTASH_REDIS_REST_TOKEN&&(i=new n.Q({url:process.env.UPSTASH_REDIS_REST_URL,token:process.env.UPSTASH_REDIS_REST_TOKEN}),s=new a.Ratelimit({redis:i,limiter:a.Ratelimit.slidingWindow(10,"10 s"),analytics:!0}))},74075:e=>{"use strict";e.exports=require("zlib")},76926:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return u}});let i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var a=o?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=e[n]}return i.default=e,r&&r.set(e,i),i}(r(61120));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}let o={current:null},n="function"==typeof i.cache?i.cache:e=>e,a=console.warn;function u(e){return function(...t){a(e(...t))}}n(e=>{try{a(o.current)}finally{o.current=null}})},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},82971:(e,t,r)=>{e.exports=r(10945)},86753:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var i=r(16467),s=r(13581),o=r(36344),n=r(65752),a=r(96330),u=r(5486);r(19854);let c=new a.PrismaClient,l={adapter:(0,i.y)(c),session:{strategy:"jwt"},pages:{signIn:"/auth/login",signOut:"/auth/logout",error:"/auth/error"},providers:[(0,s.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await c.user.findUnique({where:{email:e.email}});return t&&t.password&&await (0,u.compare)(e.password,t.password)?{id:t.id,email:t.email,name:t.name,image:t.image}:null}}),(0,o.A)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||""}),(0,n.A)({clientId:process.env.GITHUB_CLIENT_ID||"",clientSecret:process.env.GITHUB_CLIENT_SECRET||""})],callbacks:{session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.name=t.name,e.user.email=t.email,e.user.image=t.picture),e),jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e)}}},87579:(e,t,r)=>{"use strict";r.d(t,{J:()=>s});var i=r(59217);function s(e,t){return(0,i.f)(e,7*t)}},90672:(e,t,r)=>{"use strict";function i(e){let t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?e:NaN)}r.d(t,{a:()=>i})},91645:e=>{"use strict";e.exports=require("net")},94339:e=>{function t(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r)if(!this._cachedTimeouts)return!1;else this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,i=0;i<this._errors.length;i++){var s=this._errors[i],o=s.message,n=(e[o]||0)+1;e[o]=n,n>=r&&(t=s,r=n)}return t}},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[4243,580,9854,8909,9526,8420,5145,2729,1672],()=>r(55465));module.exports=i})();